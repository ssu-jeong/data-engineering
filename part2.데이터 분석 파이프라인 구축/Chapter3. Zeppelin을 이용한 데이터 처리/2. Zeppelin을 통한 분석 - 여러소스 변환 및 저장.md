## Zeppelin 켜기

EMR에서 어플리케이션이력에 가서 url복사 새로운 탭에 붙여 넣으면 노트북 확인 

![3-2-1](https://user-images.githubusercontent.com/86764734/154089927-072ad977-eb6f-41d3-bb59-c9eec7d8e50e.png)

서브메뉴인 notebook을 클릭하면 밑에 있는 노트북을 실행할 수 있는 페이지!

![3-2-2](https://user-images.githubusercontent.com/86764734/154090070-cd12aa1b-881c-4d02-bf3b-af1aa4bb474b.png)

job을 누르면 우리가 실행하는 잡들을 모니터링 할 수 있는 기능

![3-2-3](https://user-images.githubusercontent.com/86764734/154090198-a309e6cc-b737-42d7-b916-729d308976c4.png)

차후에 intrpreter 기능을 추가할 수 있는 기능도 있다.

![3-2-4](https://user-images.githubusercontent.com/86764734/154091365-cfdaa240-f961-4f19-a37d-6556b7abe665.png)

클릭해보면

![3-2-5](https://user-images.githubusercontent.com/86764734/154091464-08c5e705-96b0-4bdf-bfb6-5db851bc71bf.png)

### Intepreters

현재 zeppelin에서 지원해주고 있는 것들

![3-2-6](https://user-images.githubusercontent.com/86764734/154092123-6e2902fa-fe5d-4cf3-95f4-992483acf173.png)

- juputer

![3-2-7](https://user-images.githubusercontent.com/86764734/154092151-5dda2bc9-4670-4da2-825b-75ab64aa012c.png)

- kotlin

![3-2-8](https://user-images.githubusercontent.com/86764734/154092173-be5a9ed5-9332-4b48-a26c-16b4b650e5ed.png)

- livy

![3-2-9](https://user-images.githubusercontent.com/86764734/154092193-4f3b4ac1-a8a3-4342-9fa0-2f0a52c93337.png)

- md -> 커맨드창

![3-2-10](https://user-images.githubusercontent.com/86764734/154092208-038892e0-5ea6-4ee9-bb82-06100975b181.png)

- python

![3-2-11](https://user-images.githubusercontent.com/86764734/154092224-65ebc34c-a475-452b-8d30-998eca7c6c7e.png)

- r

![3-2-12](https://user-images.githubusercontent.com/86764734/154092234-e2339d1c-c527-454a-bc74-62e76821c931.png)

- sh

![3-2-13](https://user-images.githubusercontent.com/86764734/154092254-7fd7f45b-e645-4950-a0c6-a0cccf0b0fe3.png)

- spark

![3-2-14](https://user-images.githubusercontent.com/86764734/154092265-14726be3-7ef7-44f4-a54b-b9c3bb50ca63.png)

이 외에도 다양한 것들을 사용할 수 있다.

---


### 새로운 노트북 생성

- create new notebook

![3-2-15](https://user-images.githubusercontent.com/86764734/154093268-3494d40d-1441-4cff-9117-2ba41039b4a9.png)

우리는 강의용으로 주어진  데이터가 있기 때문에 import note 클릭

- 두가지 메뉴 중에서 셀력트 제이슨 클릭해서 제공받은 파일 선택

![3-2-16](https://user-images.githubusercontent.com/86764734/154093566-8185957e-ca0a-4d80-8090-ba831392a046.png)

이전에 만들어놨던 소스들인데, 우리는 수정된 소스를 보고 우리들의 환경에 맞게 컨버팅해서 사용하면 된다.

소스코드는 scala로 되어 있다 scala 신텍스 중에 3분의 2정도만 이해하면 스파크에서 충분히 사용가능

scala라고 써있는 소스를 오픈!!

![3-2-17](https://user-images.githubusercontent.com/86764734/154093669-ea742d8f-50f9-4cd9-a244-7f92459421c1.png)

클릭해서 열면 해당 화면이 확인된다.

![3-2-18](https://user-images.githubusercontent.com/86764734/154093779-a9ceaee0-f6e7-460c-b634-dad96e99838a.png)

이전에 s3으로 되어 있는 부분을 이렇게 확인가능   

이전과 다르게 스파크가 캡슐화라고 할까, 즉흥으로 csv파일을 읽는다.

![3-2-19](https://user-images.githubusercontent.com/86764734/154093923-96cc2625-068e-47d5-ab97-dd0017c6c028.png)

우리 로컬에 있는, 나의 S3에 있는 단지마스터.
csv을 읽어와야 하기 때문에 이것을 샘플로 해서 컨버팅하는 작업을 실습

![3-2-20](https://user-images.githubusercontent.com/86764734/154094051-b964bf4b-b3dd-4b05-9932-ddc9f15cd3e1.png)

ods라는 곳에 넣어놨으니 해당 폴더로 이동.

![3-2-21](https://user-images.githubusercontent.com/86764734/154094231-84819869-1fd3-4bfa-9211-7eaab467065e.png)

db에 있는 것을 그대로 내렸기 때문에 ods라는 폴더를 만들어서 넣었다.

여기서 단지마스터를 클릭해서 들어오면 과거에는 없었지만 url복사가 가능하다

![3-2-22](https://user-images.githubusercontent.com/86764734/154094488-a304e27e-427a-441d-abd1-07a96bf6e889.png)

복사한 주소를 붙여넣는다

![3-2-23](https://user-images.githubusercontent.com/86764734/154094610-49674a08-298d-4527-ab90-bdc846bd1d1d.png)

좀 더 설명을 하자면 csv파일은 첫번째 라인의 첫번쨰 로우에 헤더값이 있는 경우가 있고 없는 경우가 있는데, 헤더가 있다면 트루로 설정하여 첫번째 로우를 컬럼에 컬럼명으로 넣어준다.

두번째 줄은 어떤 구분자로 데이터가 구분되어 있는데 delimiter를 컴마(,)로 구분하여 데이터 프레임 형태로 읽어온다. 

세번째는 inferschema → true는 전체데이터를 읽고 숫자만 있으면 인티저로, 스트링은 스트링으로!

